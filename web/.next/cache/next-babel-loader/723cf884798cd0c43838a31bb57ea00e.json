{"ast":null,"code":"import _slicedToArray from \"C:/Users/root/Desktop/dev/frontend/web/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState } from 'react';\nimport Head from 'next/head';\nimport styles from '@pebblo/css/auth.module.css';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport { useAuth } from '../hooks/useAuth';\nimport { withApollo } from '../hooks/withApolloHook';\nimport { MeDocument, useLoginMutation } from '../generated/graphql';\n\nvar Login = function Login() {\n  var router = useRouter();\n\n  var _useState = useState(undefined),\n      usernameOrEmail = _useState[0],\n      setEmail = _useState[1];\n\n  var _useState2 = useState(undefined),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  var _useAuth = useAuth(),\n      me = _useAuth.me;\n\n  if (me && true) router.push('/'); // const [handleLogin] = useMutation(login, {\n  //     variables: { usernameOrEmail, password },\n  //     onCompleted: (data) => data.login && router.push('/explore')\n  // });\n  // const [handleLogin, { data }] = useLoginMutation(login, {\n  //     variables: { usernameOrEmail, password },\n  //     update: (cache, { data }) => {\n  //         // console.log(cache)\n  //         cache.writeQuery({\n  //             query: meQuery,\n  //             data: {\n  //                 me: data?.login.user\n  //             }\n  //         })\n  //     }\n  // });\n\n  var _useLoginMutation = useLoginMutation({\n    variables: {\n      usernameOrEmail: usernameOrEmail,\n      password: password\n    },\n    update: function update(cache, _ref) {\n      var data = _ref.data;\n      cache.writeQuery({\n        query: MeDocument,\n        data: {\n          __typename: \"Query\",\n          me: data === null || data === void 0 ? void 0 : data.login.user\n        }\n      });\n    }\n  }),\n      _useLoginMutation2 = _slicedToArray(_useLoginMutation, 2),\n      handleLogin = _useLoginMutation2[0],\n      data = _useLoginMutation2[1].data;\n\n  if (data === null || data === void 0 ? void 0 : data.login.errors) return /*#__PURE__*/_jsx(\"p\", {\n    children: JSON.stringify(data.login.errors)\n  });\n\n  if (data === null || data === void 0 ? void 0 : data.login) {\n    if (typeof router.query.next === \"string\") {\n      router.push(router.query.next);\n    } else {\n      router.push('/');\n    }\n  }\n\n  var onSubmit = function onSubmit(e) {\n    e.preventDefault();\n    handleLogin();\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Pebblo - Login\"\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: styles.auth_right,\n      children: /*#__PURE__*/_jsx(\"img\", {\n        src: \"images/svg/woman-bench.svg\"\n      })\n    }), /*#__PURE__*/_jsx(Link, {\n      href: \"/\",\n      children: /*#__PURE__*/_jsx(\"a\", {\n        href: \"/\",\n        className: styles.auth_go_back,\n        children: /*#__PURE__*/_jsx(\"span\", {})\n      })\n    }), /*#__PURE__*/_jsxs(\"form\", {\n      className: styles.auth_form,\n      onSubmit: onSubmit,\n      children: [/*#__PURE__*/_jsx(\"h1\", {\n        className: styles.auth_title,\n        children: \"Welcome back :)\"\n      }), /*#__PURE__*/_jsx(\"input\", {\n        className: styles.auth_form_username,\n        type: \"text\",\n        name: \"create_username\",\n        placeholder: \"Username or email\",\n        required: true,\n        onChange: function onChange(e) {\n          return setEmail(e.target.value);\n        }\n      }), /*#__PURE__*/_jsx(\"input\", {\n        className: styles.auth_form_password,\n        type: \"password\",\n        name: \"create_password\",\n        placeholder: \"Password\",\n        required: true,\n        onChange: function onChange(e) {\n          return setPassword(e.target.value);\n        }\n      }), /*#__PURE__*/_jsx(\"input\", {\n        type: \"submit\",\n        value: \"Login\"\n      })]\n    })]\n  });\n};\n\nLogin.theme = 'light';\nexport default withApollo({\n  ssr: false\n})(Login);","map":null,"metadata":{},"sourceType":"module"}